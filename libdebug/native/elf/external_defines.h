//
// This file is part of libdebug Python library (https://github.com/libdebug/libdebug).
// Copyright (c) 2025 Francesco Panebianco. All rights reserved.
// Licensed under the MIT license. See LICENSE file in the project root for details.
//

// -------------------- Feature Defines -------------------- //
// Many of these defines are not found in glibc's elf.h, or are
// only found in very recent versions. We define them here to avoid
// ifdef hell in the main code.

#pragma once

#ifndef GNU_PROPERTY_STACK_SIZE
 #define GNU_PROPERTY_STACK_SIZE 1
#endif
#ifndef GNU_PROPERTY_NO_COPY_ON_PROTECTED
 #define GNU_PROPERTY_NO_COPY_ON_PROTECTED 2
#endif
#ifndef GNU_PROPERTY_MEMORY_SEAL
 #define GNU_PROPERTY_MEMORY_SEAL 3
#endif

#ifndef GNU_PROPERTY_1_NEEDED
 #define GNU_PROPERTY_1_NEEDED 0xb0008000
#endif

#ifndef GNU_PROPERTY_1_NEEDED_INDIRECT_EXTERN_ACCESS
 #define GNU_PROPERTY_1_NEEDED_INDIRECT_EXTERN_ACCESS 0x00000001
#endif

#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_USED
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_USED 0xc0000000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_NEEDED
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_NEEDED 0xc0000001
#endif

#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_486
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_486 0x00000001
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_586
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_586 0x00000002
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_686
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_686 0x00000004
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_SSE
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_SSE 0x00000008
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_SSE2
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_SSE2 0x00000010
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_SSE3
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_SSE3 0x00000020
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_SSSE3
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_SSSE3 0x00000040
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_SSE4_1
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_SSE4_1 0x00000080
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_SSE4_2
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_SSE4_2 0x00000100
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX 0x00000200
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX2
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX2 0x00000400
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512F
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512F 0x00000800
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512CD
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512CD 0x00001000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512ER
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512ER 0x00002000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512PF
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512PF 0x00004000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512VL
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512VL 0x00008000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512DQ
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512DQ 0x00010000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512BW
 #define GNU_PROPERTY_X86_COMPAT_ISA_1_AVX512BW 0x00020000
#endif

#ifndef GNU_PROPERTY_X86_FEATURE_1_AND
 #define GNU_PROPERTY_X86_FEATURE_1_AND 0xc0000002
#endif

#ifndef GNU_PROPERTY_X86_ISA_1_NEEDED
 #define GNU_PROPERTY_X86_ISA_1_NEEDED 0xc0008002
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_NEEDED
 #define GNU_PROPERTY_X86_FEATURE_2_NEEDED 0xc0008001
#endif

#ifndef GNU_PROPERTY_X86_ISA_1_USED
 #define GNU_PROPERTY_X86_ISA_1_USED 0xc0010002
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_USED
 #define GNU_PROPERTY_X86_FEATURE_2_USED 0xc0010001
#endif

// Bits for X64 ISA features
#ifndef GNU_PROPERTY_X86_ISA_1_BASELINE
 #define GNU_PROPERTY_X86_ISA_1_BASELINE 0x00000001
#endif
#ifndef GNU_PROPERTY_X86_ISA_1_V2
 #define GNU_PROPERTY_X86_ISA_1_V2 0x00000002
#endif
#ifndef GNU_PROPERTY_X86_ISA_1_V3
 #define GNU_PROPERTY_X86_ISA_1_V3 0x00000004
#endif
#ifndef GNU_PROPERTY_X86_ISA_1_V4
 #define GNU_PROPERTY_X86_ISA_1_V4 0x00000008
#endif

// Bits for X86 Feature Set 1
#ifndef GNU_PROPERTY_X86_FEATURE_1_IBT
 #define GNU_PROPERTY_X86_FEATURE_1_IBT 0x00000001
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_1_SHSTK
 #define GNU_PROPERTY_X86_FEATURE_1_SHSTK 0x00000002
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_1_LAM_U48
 #define GNU_PROPERTY_X86_FEATURE_1_LAM_U48 0x00000004
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_1_LAM_U57
 #define GNU_PROPERTY_X86_FEATURE_1_LAM_U57 0x00000008
#endif

// Bits for X86 Feature Set 2
#ifndef GNU_PROPERTY_X86_FEATURE_2_X86
 #define GNU_PROPERTY_X86_FEATURE_2_X86 0x00000001
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_X87
 #define GNU_PROPERTY_X86_FEATURE_2_X87 0x00000002
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_MMX
 #define GNU_PROPERTY_X86_FEATURE_2_MMX 0x00000004
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_XMM
 #define GNU_PROPERTY_X86_FEATURE_2_XMM 0x00000008
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_YMM
 #define GNU_PROPERTY_X86_FEATURE_2_YMM 0x00000010
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_ZMM
 #define GNU_PROPERTY_X86_FEATURE_2_ZMM 0x00000020
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_FXSR
 #define GNU_PROPERTY_X86_FEATURE_2_FXSR 0x00000040
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_XSAVE
 #define GNU_PROPERTY_X86_FEATURE_2_XSAVE 0x00000080
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_XSAVEOPT
 #define GNU_PROPERTY_X86_FEATURE_2_XSAVEOPT 0x00000100
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_XSAVEC
 #define GNU_PROPERTY_X86_FEATURE_2_XSAVEC 0x00000200
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_TMM
 #define GNU_PROPERTY_X86_FEATURE_2_TMM 0x00000400
#endif
#ifndef GNU_PROPERTY_X86_FEATURE_2_MASK
 #define GNU_PROPERTY_X86_FEATURE_2_MASK 0x00000800
#endif

// Bits for X86 Compatibility Feature Set 2
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_NEEDED
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_NEEDED 0xc0008000
#endif

#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_USED
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_USED 0xc0010000
#endif

#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_CMOV
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_CMOV 0x00000001
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE 0x00000002
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE2
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE2 0x00000004
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE3
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE3 0x00000008
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSSE3
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSSE3 0x00000010
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE4_1
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE4_1 0x00000020
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE4_2
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_SSE4_2 0x00000040
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX 0x00000080
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX2
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX2 0x00000100
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_FMA
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_FMA 0x00000200
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512F
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512F 0x00000400
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512CD
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512CD 0x00000800
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512ER
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512ER 0x00001000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512PF
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512PF 0x00002000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512VL
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512VL 0x00004000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512DQ
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512DQ 0x00008000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512BW
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512BW 0x00010000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_4FMAPS
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_4FMAPS 0x00020000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_4VNNIW
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_4VNNIW 0x00040000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_BITALG
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_BITALG 0x00080000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_IFMA
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_IFMA 0x00100000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_VBMI
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_VBMI 0x00200000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_VBMI2
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_VBMI2 0x00400000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_VNNI
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_VNNI 0x00800000
#endif
#ifndef GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_BF16
 #define GNU_PROPERTY_X86_COMPAT_2_ISA_1_AVX512_BF16 0x01000000
#endif

/* AArch64 specific GNU PROPERTY. */
#ifndef GNU_PROPERTY_AARCH64_FEATURE_1_AND
 #define GNU_PROPERTY_AARCH64_FEATURE_1_AND 0xc0000000
#endif

#ifndef GNU_PROPERTY_AARCH64_FEATURE_1_BTI
 #define GNU_PROPERTY_AARCH64_FEATURE_1_BTI 0x00000001
#endif
#ifndef GNU_PROPERTY_AARCH64_FEATURE_1_PAC
 #define GNU_PROPERTY_AARCH64_FEATURE_1_PAC 0x00000002
#endif
#ifndef GNU_PROPERTY_AARCH64_FEATURE_1_GCS
 #define GNU_PROPERTY_AARCH64_FEATURE_1_GCS 0x00000004
#endif

// -------------------- x86_64 specific section types and flags -------------------- //

#ifndef SHT_X86_64_UNWIND
 #define SHT_X86_64_UNWIND 0x70000001
#endif

#ifndef SHN_X86_64_LCOMMON
 #define SHN_X86_64_LCOMMON 0xff02
#endif

#ifndef SHF_X86_64_LARGE
 #define SHF_X86_64_LARGE 0x10000000
#endif

#ifndef DT_X86_64_PLT
 #define DT_X86_64_PLT 0x70000000
#endif
#ifndef DT_X86_64_PLTSZ
 #define DT_X86_64_PLTSZ 0x70000001
#endif
#ifndef DT_X86_64_PLTENT
 #define DT_X86_64_PLTENT 0x70000003
#endif

// -------------------- AARCH64 specific section types and flags -------------------- //

#ifndef PT_AARCH64_ARCHEXT
 #define PT_AARCH64_ARCHEXT 0x70000000
#endif

#ifndef PT_AARCH64_MEMTAG_MTE
 #define PT_AARCH64_MEMTAG_MTE 0x70000002
#endif

#ifndef SHT_AARCH64_ATTRIBUTES
 #define SHT_AARCH64_ATTRIBUTES 0x70000003
#endif
#ifndef SHT_AARCH64_AUTH_RELR
 #define SHT_AARCH64_AUTH_RELR 0x70000004
#endif
#ifndef SHT_AARCH64_MEMTAG_GLOBALS_STATIC
 #define SHT_AARCH64_MEMTAG_GLOBALS_STATIC 0x70000007
#endif
#ifndef SHT_AARCH64_MEMTAG_GLOBALS_DYNAMIC
 #define SHT_AARCH64_MEMTAG_GLOBALS_DYNAMIC 0x70000008
#endif

#ifndef SHF_ENTRYSECT
 #define SHF_ENTRYSECT 0x10000000
#endif
#ifndef SHF_COMDEF
 #define SHF_COMDEF 0x80000000
#endif
#ifndef DT_AARCH64_BTI_PLT
 #define DT_AARCH64_BTI_PLT 0x70000001
#endif
#ifndef DT_AARCH64_PAC_PLT
 #define DT_AARCH64_PAC_PLT 0x70000003
#endif
#ifndef DT_AARCH64_VARIANT_PCS
 #define DT_AARCH64_VARIANT_PCS 0x70000005
#endif
#ifndef DT_AARCH64_MEMTAG_MODE
 #define DT_AARCH64_MEMTAG_MODE 0x70000009
#endif
#ifndef DT_AARCH64_MEMTAG_STACK
 #define DT_AARCH64_MEMTAG_STACK 0x7000000C
#endif
